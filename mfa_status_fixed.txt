def mfa_status() -> dict:
    """Check MFA/Windows Hello status"""
    results = {"windows_hello": None, "biometric": None, "pin": None}
    
    # Method 1: Check NGC (Next Generation Credentials) folder
    ps = 'powershell -NoProfile -Command "Test-Path \'$env:WINDIR\\ServiceProfiles\\LocalService\\AppData\\Local\\Microsoft\\Ngc\' -or (Test-Path \'$env:LOCALAPPDATA\\Microsoft\\Ngc\')"'
    code, out, _ = run_cmd(ps)
    ngc_exists = code == 0 and "True" in out
   
    # Method 2: Check Windows Hello for Business registry
    ps2_cmd = 'powershell -NoProfile -Command "Get-ItemProperty -Path \'HKLM:\\SOFTWARE\\Policies\\Microsoft\\PassportForWork\' -ErrorAction SilentlyContinue | ConvertTo-Json"'
    code2, out2, _ = run_cmd(ps2_cmd)
    hello_policy = False
    if code2 == 0 and out2 and out2.strip() not in ["", "null"]:
        try:
            import json
            data = json.loads(out2)
            if isinstance(data, dict) and data:
                hello_policy = True
        except Exception:
            pass
   
    # Method 3: Check credential provider for PIN
    code3, out3, _ = run_cmd('reg query "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Authentication\\Credential Providers\\{60b78e88-ead8-445c-9cfd-0b87f74ea6cd}" /v Disabled')
    pin_provider_enabled = code3 != 0 or "0x0" in out3  # Provider enabled if key doesn't exist or Disabled=0
   
    # Method 4: Check user has NGC keys (actual PIN configured)
    ps4_cmd = 'powershell -NoProfile -Command "Get-ChildItem \'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Authentication\\Credential Providers\' -Recurse | Where-Object {$_.Name -like \'*NGC*\'} | Measure-Object | Select-Object -ExpandProperty Count"'
    code4, out4, _ = run_cmd(ps4_cmd)
    ngc_providers = code4 == 0 and out4.strip().isdigit() and int(out4.strip()) > 0
   
    # Determine if Windows Hello/PIN is actually configured
    results["windows_hello"] = "enabled" if (ngc_exists or hello_policy or ngc_providers) else "not_detected"
    results["pin"] = ngc_exists or pin_provider_enabled
    
    # Check for biometric devices  
    ps5_cmd = 'powershell -NoProfile -Command "(Get-PnpDevice -Class Biometric -Status OK -ErrorAction SilentlyContinue | Measure-Object).Count"'
    code5, out5, _ = run_cmd(ps5_cmd)
    if code5 == 0 and out5.strip().isdigit():
        results["biometric"] = int(out5.strip()) > 0
    
    return results
